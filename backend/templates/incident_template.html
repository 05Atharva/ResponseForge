<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ company_name }} - Computer Security Incident Handling Guide</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .header .subtitle {
            color: #34495e;
            font-size: 1.2em;
            margin: 10px 0;
            font-style: italic;
        }
        .header .company-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-weight: bold;
        }
        .metadata {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .metadata-item {
            display: flex;
            flex-direction: column;
        }
        .metadata-label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.9em;
            text-transform: uppercase;
        }
        .metadata-value {
            color: #34495e;
            font-size: 1.1em;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #555;
            margin-top: 25px;
        }
        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 30px 0;
        }
        .toc h2 {
            margin-top: 0;
            color: #2c3e50;
        }
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px dotted #bdc3c7;
        }
        .toc a {
            text-decoration: none;
            color: #3498db;
            display: flex;
            justify-content: space-between;
        }
        .toc a:hover {
            color: #2980b9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.9em;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
        .priority-critical { background-color: #fee; }
        .priority-high { background-color: #fef5e7; }
        .priority-medium { background-color: #f0f8ff; }
        .priority-low { background-color: #f0fff0; }
        .section-highlight {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .checklist {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
        }
        .checklist h3 {
            color: #28a745;
            margin-top: 0;
        }
        .template-form {
            background: #f8f9fa;
            border: 2px dashed #6c757d;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .appendix {
            background: #e9ecef;
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
            border-left: 5px solid #6f42c1;
        }
        .page-number {
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
            margin: 20px 0;
        }
        .dynamic-section {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #17a2b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ARTEMIS</h1>
            <div class="subtitle">Advanced Reactive Threat Elimination and Monitoring Integrated System</div>
            <div class="subtitle" style="font-size: 1.5em; margin: 20px 0;">Computer Security Incident Handling Guide</div>
            <div class="subtitle">Inspired by the recommendations of the National Institute of Standards and Technology</div>
            <div class="company-info">
                {{ company_name }} - {{ industry_sector }} Sector
            </div>
        </div>

        <div class="metadata">
            <div class="metadata-item">
                <span class="metadata-label">Plan Author</span>
                <span class="metadata-value">{{ plan_author }}</span>
            </div>
            <div class="metadata-item">
                <span class="metadata-label">Plan Approver</span>
                <span class="metadata-value">{{ plan_approver }}</span>
            </div>
            <div class="metadata-item">
                <span class="metadata-label">Issue Date</span>
                <span class="metadata-value">{{ plan_issue_date }}</span>
            </div>
            <div class="metadata-item">
                <span class="metadata-label">Next Review Date</span>
                <span class="metadata-value">{{ next_review_date }}</span>
            </div>
            <div class="metadata-item">
                <span class="metadata-label">Company Size</span>
                <span class="metadata-value">{{ company_size }}</span>
            </div>
            <div class="metadata-item">
                <span class="metadata-label">Infrastructure Type</span>
                <span class="metadata-value">{{ infrastructure_type }}</span>
            </div>
        </div>

        <div class="page-number">2 | Page</div>

        <div class="toc">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#executive-summary">Executive Summary <span>1</span></a></li>
                <li><a href="#introduction">1. Introduction <span>4</span></a>
                    <ul style="margin-left: 20px;">
                        <li><a href="#authority">1.1 Authority <span>4</span></a></li>
                        <li><a href="#purpose-scope">1.2 Purpose and Scope <span>4</span></a></li>
                        <li><a href="#audience">1.3 Audience <span>4</span></a></li>
                        <li><a href="#document-structure">1.4 Document Structure <span>4</span></a></li>
                    </ul>
                </li>
                <li><a href="#organizing">2. Organizing a Computer Security Incident Response Capability <span>5</span></a>
                    <ul style="margin-left: 20px;">
                        <li><a href="#events-incidents">2.1 Events and Incidents <span>6</span></a></li>
                        <li><a href="#need-response">2.2 Need for Incident Response <span>5</span></a></li>
                        <li><a href="#team-structure">2.3 Incident Response Team Structure <span>6</span></a></li>
                    </ul>
                </li>
                <li><a href="#handling">3. Handling an Incident <span>10</span></a>
                    <ul style="margin-left: 20px;">
                        <li><a href="#preparation">3.1 Preparation <span>10</span></a></li>
                        <li><a href="#detection-analysis">3.2 Detection and Analysis <span>13</span></a></li>
                        <li><a href="#containment-eradication-recovery">3.3 Containment, Eradication, and Recovery <span>19</span></a></li>
                        <li><a href="#post-incident">3.4 Post-Incident Activity <span>21</span></a></li>
                    </ul>
                </li>
                <li><a href="#coordination">4. Coordination and Information Sharing <span>24</span></a></li>
            </ul>
        </div>

        <div class="page-number">3 | Page</div>

        <h2>List of Appendices</h2>
        <ul>
            <li><a href="#appendix-a">Appendix A— Situation update (template)</a> <span style="float: right;">27</span></li>
            <li><a href="#appendix-b">Appendix B— Resolution Action Plan (template)</a> <span style="float: right;">28</span></li>
            <li><a href="#appendix-c">Appendix C— Evidence Register (template)</a> <span style="float: right;">29</span></li>
            <li><a href="#appendix-d">Appendix D— Assets and Key Contacts (template)</a> <span style="float: right;">30</span></li>
            <li><a href="#appendix-e">Appendix E— Glossary</a> <span style="float: right;">34</span></li>
        </ul>

        <div class="page-number">4 | Page</div>

        <h1 id="introduction">1. Introduction</h1>

        <h2 id="context">1.1 Context</h2>
        <p>Cyber security relates to the confidentiality, availability and integrity of information and data that is processed, stored and communicated by electronic or similar means, and protecting it and associated systems from external or internal threat.</p>
        
        <p>It is commonly recognized that cyber security involves the protection of critical information and ICT infrastructure, including supervisory control and data acquisition (SCADA) systems and industrial control systems (ICS), through the alignment of people, processes and tools.</p>
        
        <div class="dynamic-section">
            <p><strong>Organization-Specific Context:</strong> This document supports <strong>{{ company_name }}</strong> in managing contemporary cyber threats and incidents within the <strong>{{ industry_sector }}</strong> sector. The application of this document will support the organization in reducing the scope, impact and severity of cyber incidents across our <strong>{{ infrastructure_type }}</strong> infrastructure serving <strong>{{ number_of_endpoints }}</strong> endpoints.</p>
        </div>

        <h2 id="purpose-scope">1.2 Purpose and Scope</h2>
        <p>This publication seeks to assist {{ company_name }} in mitigating the risks from computer security incidents by providing practical guidelines on responding to incidents effectively and efficiently. It includes guidelines on establishing an effective incident response program, but the primary focus of the document is detecting, analyzing, prioritizing, and handling incidents.</p>
        
        <div class="dynamic-section">
            {{ audience_scope_section }}
        </div>

        <h2 id="authority">1.3 Authority</h2>
        <p>This guideline has been prepared for use by {{ company_name }}. It may be used by partner organizations on a voluntary basis and is subject to copyright.</p>
        
        <p><strong>Confidentiality Notice:</strong> Not even the makers of this document can access any confidential information filled in the appendices.</p>

        <div class="dynamic-section">
            {{ compliance_section }}
        </div>

        <h2 id="audience">1.4 Audience</h2>
        <p>This document has been created for computer security incident response teams (CSIRTs), system and network administrators, security staff, technical support staff, chief information security officers (CISOs), chief information officers (CIOs), computer security program managers, and others who are responsible for preparing for, or responding to security incidents of {{ company_name }}.</p>

        <div class="dynamic-section">
            <strong>Specific Audience Roles for {{ company_name }}:</strong>
            {{ audience_roles }}
        </div>

        <div class="page-number">5 | Page</div>

        <h1 id="organizing">2. Organizing a Computer Security Incident Response Capability</h1>
        
        <p>Organizing an effective computer security incident response capability (CSIRC) involves several major decisions and actions. One of the first considerations should be to create an organization-specific definition of the term "incident" so that the scope of the term is clear. The organization should decide what services the incident response team should provide, consider which team structures and models can provide those services, and select and implement one or more incident response teams. Incident response plan, policy, and procedure creation is an important part of establishing a team, so that incident response is performed effectively, efficiently, and consistently, and so that the team is empowered to do what needs to be done. The plan, policies, and procedures should reflect the team's interactions with other teams within the organization as well as with outside parties, such as law enforcement, the media, and other incident response organizations. This section provides not only guidelines that should be helpful to organizations that are establishing incident response capabilities, but also advice on maintaining and enhancing existing capabilities.</p>

        <h2 id="events-incidents">2.1 What is a computer security incident?</h2>
        <p>A computer security incident is a violation or imminent threat of violation of computer security policies, acceptable use policies, or standard security practices. Examples of incidents are:</p>
        <ul>
            <li>An attacker commands a botnet to send high volumes of connection requests to a web server, causing it to crash.</li>
            <li>Users are tricked into opening a "quarterly report" sent via email that is actually malware; running the tool has infected their computers and established connections with an external host.</li>
            <li>An attacker obtains sensitive data and threatens that the details will be released publicly if the organization does not pay a designated sum of money.</li>
            <li>A user provides or exposes sensitive information to others through peer-to-peer file sharing services.</li>
        </ul>

        <div class="section-highlight">
            <h3>Top Threats for {{ company_name }}</h3>
            <p>Based on our industry sector and infrastructure, the most relevant threats include: <strong>{{ top_threats | join(', ') }}</strong></p>
        </div>

        <h2 id="need-response">2.2 Need for Incident Response</h2>
        <p>Attacks frequently compromise personal and business data, and it is critical to respond quickly and effectively when security breaches occur. The concept of computer security incident response has become widely accepted and implemented. One of the benefits of having an incident response capability is that it supports responding to incidents systematically (i.e., following a consistent incident handling methodology) so that the appropriate actions are taken. Incident response helps personnel to minimize loss or theft of information and disruption of services caused by incidents.</p>

        <div class="dynamic-section">
            {{ prior_breach_section }}
        </div>

        <div class="page-number">6 | Page</div>

        <h2 id="team-structure">2.3 Incident Response Team Structure</h2>
        <p>An incident response team should be available for anyone who discovers or suspects that an incident involving {{ company_name }} has occurred. One or more team members, depending on the magnitude of the incident and availability of personnel, will then handle the incident. The incident handlers analyze the incident data, determine the impact of the incident, and act appropriately to limit the damage and restore normal services. The incident response team's success depends on the participation and cooperation of individuals throughout the organization. This section identifies such individuals, discusses incident response team models, and provides advice on selecting an appropriate model.</p>

        <div class="dynamic-section">
            {{ csirt_section }}
        </div>

        <h3>2.3.1 Team Models</h3>
        <p>Possible structures for an incident response team include the following:</p>
        <ul>
            <li><strong>Central Incident Response Team.</strong> A single incident response team handles incidents throughout the organization. This model is effective for small organizations and for organizations with minimal geographic diversity in terms of computing resources.</li>
            <li><strong>Distributed Incident Response Teams.</strong> The organization has multiple incident response teams, each responsible for a particular logical or physical segment of the organization. This model is effective for large organizations (e.g., one team per division) and for organizations with major computing resources at distant locations (e.g., one team per geographic region, one team per major facility). However, the teams should be part of a single coordinated entity so that the incident response process is consistent across the organization and information is shared among teams. This is particularly important because multiple teams may see components of the same incident or may handle similar incidents.</li>
            <li><strong>Coordinating Team.</strong> An incident response team provides advice to other teams without having authority over those teams—for example; a department wide team may assist individual agencies' teams. This model can be thought of as a CSIRT for CSIRTs.</li>
        </ul>

        <p>Incident response teams can also use any of three staffing models:</p>
        <ul>
            <li><strong>Employees.</strong> The organization performs all of its incident response work, with limited technical and administrative support from contractors.</li>
            <li><strong>Partially Outsourced.</strong> The organization outsources portions of its incident response work. Although incident response duties can be divided among the organization and one or more outsourcers in many ways, a few arrangements have become commonplace.</li>
            <li><strong>Fully Outsourced.</strong> The organization completely outsources its incident response work, typically to an onsite contractor. This model is most likely to be used when the organization needs a full-time, onsite incident response team but does not have enough available, qualified employees. It is assumed that the organization will have employees supervising and overseeing the outsourcer's work.</li>
        </ul>

        <div class="page-number">7 | Page</div>

        <h3>2.3.2 Team Model Selection</h3>
        <p>When selecting appropriate structure and staffing models for an incident response team, organizations should consider the following factors:</p>
        <ol>
            <li>The Need for 24/7 Availability.</li>
            <li>Full-Time Versus Part-Time Team Members.</li>
            <li>Employee Morale.</li>
            <li>Cost.</li>
            <li>Staff Expertise.</li>
            <li>Current and Future Quality of Work.</li>
            <li>Division of Responsibilities.</li>
            <li>Sensitive Information Revealed to the Contractor.</li>
            <li>Lack of Organization-Specific Knowledge.</li>
            <li>Lack of Correlation.</li>
            <li>Handling Incidents at Multiple Locations.</li>
            <li>Maintaining Incident Response Skills In-House.</li>
        </ol>

        <div class="page-number">8 | Page</div>

        <h3>2.3.3 Incident Response Personnel</h3>
        <p>A single employee, with one or more designated alternates, should be in charge of incident response. In a fully outsourced model, this person oversees and evaluates the outsourcer's work. All other models generally have a team manager and one or more deputies who assumes authority in the absence of the team manager. The managers typically perform a variety of tasks, including acting as a liaison with upper management and other teams and organizations, defusing crisis situations, and ensuring that the team has the necessary personnel, resources, and skills. Managers should be technically adept and have excellent communication skills, particularly an ability to communicate to a range of audiences. Managers are ultimately responsible for ensuring that incident response activities are performed properly.</p>

        <div class="section-highlight">
            <h4>Incident Commander for {{ company_name }}</h4>
            <p><strong>{{ incident_commander }}</strong></p>
        </div>

        <p>In addition to the team manager and deputy, some teams also have a technical lead—a person with strong technical skills and incident response experience who assumes oversight of and final responsibility for the quality of the team's technical work. The position of technical lead should not be confused with the position of incident lead. Larger teams often assign an incident lead as the primary POC for handling a specific incident; the incident lead is held accountable for the incident's handling. Depending on the size of the incident response team and the magnitude of the incident, the incident lead may not actually perform any actual incident handling, but rather coordinate the handlers' activities, gather information from the handlers, provide incident updates to other groups, and ensure that the team's needs are met.</p>

        <p>Members of the incident response team should have excellent technical skills, such as system administration, network administration, programming, technical support, or intrusion detection. Every team member should have good problem solving skills and critical thinking abilities. It is not necessary for every team member to be a technical expert—to a large degree, practical and funding considerations will dictate this—but having at least one highly proficient person in each major area of technology (e.g., commonly attacked operating systems and applications) is a necessity. It may also be helpful to have some team members specialize in particular technical areas, such as network intrusion detection, malware analysis, or forensics. It is also often helpful to temporarily bring in technical specialists that aren't normally part of the team.</p>

        <div class="page-number">9 | Page</div>

        <p>Incident response team members should have other skills in addition to technical expertise. Teamwork skills are of fundamental importance because cooperation and coordination are necessary for successful incident response. Every team member should also have good communication skills. Speaking skills are important because the team will interact with a wide variety of people, and writing skills are important when team members are preparing advisories and procedures. Although not everyone within a team needs to have strong writing and speaking skills, at least a few people within every team should possess them so the team can represent itself well in front of others.</p>

        <h3>2.3.4 Incident Response Team Services</h3>
        <p>The main focus of an incident response team is performing incident response, but it is fairly rare for a team to perform incident response only. The following are examples of other services a team might offer:</p>
        <ul>
            <li><strong>Intrusion Detection.</strong> The first tier of an incident response team often assumes responsibility for intrusion detection. The team generally benefits because it should be poised to analyze incidents more quickly and accurately, based on the knowledge it gains of intrusion detection technologies.</li>
            <li><strong>Advisory Distribution.</strong> A team may issue advisories within the organization regarding new vulnerabilities and threats. Automated methods should be used whenever appropriate to disseminate information; for example, the National Vulnerability Database (NVD) provides information via XML and RSS feeds when new vulnerabilities are added to it. Advisories are often most necessary when new threats are emerging, such as a high-profile social or political event (e.g., celebrity wedding) that attackers are likely to leverage in their social engineering. Only one group within the organization should distribute computer security advisories to avoid duplicated effort and conflicting information.</li>
            <li><strong>Education and Awareness.</strong> Education and awareness are resource multipliers—the more the users and technical staff know about detecting, reporting, and responding to incidents, the less drain there should be on the incident response team. This information can be communicated through many means: workshops, websites, newsletters, posters, and even stickers on monitors and laptops.</li>
            <li><strong>Information Sharing.</strong> Incident response teams often participate in information sharing groups, such as ISACs or regional partnerships. Accordingly, incident response teams often manage the organization's incident information sharing efforts, such as aggregating information related to incidents and effectively sharing that information with other organizations, as well as ensuring that pertinent information is shared within the enterprise.</li>
        </ul>

        <div class="page-number">10 | Page</div>

        <h1 id="handling">3. Handling an incident</h1>
        
        <p>The incident response process has several phases. The initial phase involves establishing and training an incident response team, and acquiring the necessary tools and resources. During preparation, the organization also attempts to limit the number of incidents that will occur by selecting and implementing a set of controls based on the results of risk assessments. However, residual risk will inevitably persist after controls are implemented. Detection of security breaches is thus necessary to alert the organization whenever incidents occur. In keeping with the severity of the incident, the organization can mitigate the impact of the incident by containing it and ultimately recovering from it. During this phase, activity often cycles back to detection and analysis—for example, to see if additional hosts are infected by malware while eradicating a malware incident. After the incident is adequately handled, the organization issues a report that details the cause and cost of the incident and the steps the organization should take to prevent future incidents. This section describes the major phases of the incident response process—preparation, detection and analysis, containment, eradication and recovery, and post-incident activity—in detail.</p>

        <div style="text-align: center; margin: 30px 0;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; display: inline-block;">
                <h3 style="margin: 0; color: white;">Figure 3-1. Incident Response Life Cycle</h3>
                <div style="margin: 15px 0;">
                    <div style="display: inline-block; margin: 10px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px;">Preparation</div>
                    <div style="display: inline-block; margin: 10px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px;">Detection & Analysis</div>
                    <div style="display: inline-block; margin: 10px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px;">Containment, Eradication & Recovery</div>
                    <div style="display: inline-block; margin: 10px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px;">Post-Incident Activity</div>
                </div>
            </div>
        </div>

        <h2 id="preparation">3.1 Preparation</h2>
        <p>Incident response methodologies typically emphasize preparation—not only establishing an incident response capability so that the organization is ready to respond to incidents, but also preventing incidents by ensuring that systems, networks, and applications are sufficiently secure. Although the incident response team is not typically responsible for incident prevention, it is fundamental to the success of incident response programs. This section provides basic advice on preparing to handle incidents and on preventing incidents.</p>

        <h3>3.1.1 Preparing to Handle Incidents</h3>

        <div class="dynamic-section">
            {{ infra_summary_section }}
        </div>

        <h4>Incident Handler Communications and Facilities:</h4>
        <ul>
            <li>Contact information for team members and others within and outside the organization (primary and backup contacts), such as law enforcement and other incident response teams; information may include phone numbers, email addresses, public encryption keys (in accordance with the encryption software described below), and instructions for verifying the contact's identity</li>
            <li>On-call information for other teams within the organization, including escalation information</li>
            <li>Incident reporting mechanisms, such as phone numbers, email addresses, online forms, and secure instant messaging systems that users can use to report suspected incidents; at least one mechanism should permit people to report incidents anonymously</li>
            <li>Issue tracking system for tracking incident information, status, etc.</li>
            <li>Smartphones to be carried by team members for off-hour support and onsite communications</li>
            <li>Encryption software to be used for communications among team members, within the organization and with external parties; for Federal agencies, software must use a FIPS-validated encryption algorithm</li>
            <li>War room for central communication and coordination; if a permanent war room is not necessary or practical, the team should create a procedure for procuring a temporary war room when needed</li>
            <li>Secure storage facility for securing evidence and other sensitive materials</li>
        </ul>

        <div class="page-number">11 | Page</div>

        <h4>Incident Analysis Hardware and Software:</h4>
        <ul>
            <li>Digital forensic workstations and/or backup devices to create disk images, preserve log files, and save other relevant incident data</li>
            <li>Laptops for activities such as analyzing data, sniffing packets, and writing reports</li>
            <li>Spare workstations, servers, and networking equipment, or the virtualized equivalents, which may be used for many purposes, such as restoring backups and trying out malware</li>
            <li>Portable printer to print copies of log files and other evidence from non-networked systems</li>
            <li>Packet sniffers and protocol analyzers to capture and analyze network traffic</li>
            <li>Digital forensic software to analyze disk images</li>
            <li>Removable media with trusted versions of programs to be used to gather evidence from systems</li>
            <li>Evidence gathering accessories, including hard-bound notebooks, digital cameras, audio recorders, chain of custody forms, evidence storage bags and tags, and evidence tape, to preserve evidence for possible legal actions</li>
        </ul>

        <div class="section-highlight">
            <h4>Detection and Response Tools for {{ company_name }}</h4>
            <ul>
                <li><strong>EDR/SIEM:</strong> {{ edr_siem_used }}</li>
                <li><strong>Detection Tools:</strong> {{ detection_tools }}</li>
                <li><strong>Firewall Tools:</strong> {{ firewall_tools }}</li>
                <li><strong>Cloud Services:</strong> {{ cloud_services | join(', ') }}</li>
            </ul>
        </div>

        <div class="page-number">12 | Page</div>

        <h4>Incident Analysis Resources:</h4>
        <ul>
            <li>Port lists, including commonly used ports and Trojan horse ports</li>
            <li>Documentation for OSs, applications, protocols, and intrusion detection and antivirus products</li>
            <li>Network diagrams and lists of critical assets, such as database servers</li>
            <li>Current baselines of expected network, system, and application activity</li>
            <li>Cryptographic hashes of critical files to speed incident analysis, verification, and eradication</li>
        </ul>

        <div class="section-highlight">
            <h4>Critical Systems for {{ company_name }}</h4>
            <p><strong>{{ critical_systems }}</strong></p>
        </div>

        <h3>3.1.2 Preventing Incidents</h3>
        <p>Keeping the number of incidents reasonably low is very important to protect the business processes of the organization. If security controls are insufficient, higher volumes of incidents may occur, overwhelming the incident response team. This can lead to slow and incomplete responses, which translate to a larger negative business impact.</p>
        
        <p>The following text, however, provides a brief overview of some of the main recommended practices for securing networks, systems, and applications:</p>
        <ul>
            <li><strong>Risk Assessments.</strong> Periodic risk assessments of systems and applications should determine what risks are posed by combinations of threats and vulnerabilities. This should include understanding the applicable threats, including organization-specific threats. Each risk should be prioritized, and the risks can be mitigated, transferred, or accepted until a reasonable overall level of risk is reached. Another benefit of conducting risk assessments regularly is that critical resources are identified, allowing staff to emphasize monitoring and response activities for those resources.</li>
            <li><strong>Host Security.</strong> All hosts should be hardened appropriately using standard configurations. In addition to keeping each host properly patched, hosts should be configured to follow the principle of least privilege—granting users only the privileges necessary for performing their authorized tasks.</li>
            <li><strong>Network Security.</strong> The network perimeter should be configured to deny all activity that is not expressly permitted. This includes securing all connection points, such as virtual private networks (VPNs) and dedicated connections to other organizations.</li>
            <li><strong>Malware Prevention.</strong> Software to detect and stop malware should be deployed throughout the organization. Malware protection should be deployed at the host level (e.g., server and workstation operating systems), the application server level (e.g., email server, web proxies), and the application client level (e.g., email clients, instant messaging clients).</li>
            <li><strong>User Awareness and Training.</strong> Users should be made aware of policies and procedures regarding appropriate use of networks, systems, and applications. Applicable lessons learned from previous incidents should also be shared with users so they can see how their actions could affect the organization. Improving user awareness regarding incidents should reduce the frequency of incidents.</li>
        </ul>

        <div class="page-number">13 | Page</div>

        <h2 id="detection-analysis">3.2 Detection and Analysis</h2>

        <h3>3.2.1 Attack Vectors</h3>
        <p>Incidents can occur in countless ways, so it is infeasible to develop step-by-step instructions for handling every incident. Organizations should be generally prepared to handle any incident but should focus on being prepared to handle incidents that use common attack vectors. Different types of incidents merit different response strategies. The attack vectors listed below are not intended to provide definitive classification for incidents; rather, they simply list common methods of attack, which can be used as a basis for defining more specific handling procedures.</p>
        
        <ul>
            <li><strong>External/Removable Media:</strong> An attack executed from removable media or a peripheral device—for example, malicious code spreading onto a system from an infected USB flash drive.</li>
            <li><strong>Attrition:</strong> An attack that employs brute force methods to compromise, degrade, or destroy systems, networks, or services (e.g., a DDoS intended to impair or deny access to a service or application; a brute force attack against an authentication mechanism, such as passwords, CAPTCHAS, or digital signatures).</li>
            <li><strong>Web:</strong> An attack executed from a website or web-based application—for example, a cross-site scripting attack used to steal credentials or a redirect to a site that exploits a browser vulnerability and installs malware.</li>
            <li><strong>Email:</strong> An attack executed via an email message or attachment—for example, exploit code disguised as an attached document or a link to a malicious website in the body of an email message.</li>
            <li><strong>Impersonation:</strong> An attack involving replacement of something benign with something malicious—for example, spoofing, man in the middle attacks, rogue wireless access points, and SQL injection attacks all involve impersonation.</li>
            <li><strong>Improper Usage:</strong> Any incident resulting from violation of an organization's acceptable usage policies by an authorized user, excluding the above categories; for example, a user installs file sharing software, leading to the loss of sensitive data; or a user performs illegal activities on a system.</li>
            <li><strong>Loss or Theft of Equipment:</strong> The loss or theft of a computing device or media used by the organization, such as a laptop, smartphone, or authentication token.</li>
            <li><strong>Other:</strong> An attack that does not fit into any of the other categories.</li>
        </ul>

        <div class="page-number">14 | Page</div>

        <h3>3.2.2 Signs of an Incident</h3>
        <p>For many organizations, the most challenging part of the incident response process is accurately detecting and assessing possible incidents—determining whether an incident has occurred and, if so, the type, extent, and magnitude of the problem. What makes this so challenging is a combination of three factors:</p>
        
        <p>Common indicators of the attack include:</p>
        <ul>
            <li>Web server log entries that show the usage of a vulnerability scanner</li>
            <li>An announcement of a new exploit that targets a vulnerability of the organization's mail server</li>
            <li>A threat from a group stating that the group will attack the organization.</li>
        </ul>
        
        <p>While precursors are relatively rare, indicators are all too common. Too many types of indicators exist to exhaustively list them, but some examples are listed below:</p>
        <ul>
            <li>A network intrusion detection sensor alerts when a buffer overflow attempt occurs against database server.</li>
            <li>Antivirus software alerts when it detects that a host is infected with malware.</li>
            <li>A system administrator sees a filename with unusual characters.</li>
            <li>A host records an auditing configuration change in its log.</li>
            <li>An application logs multiple failed login attempts from an unfamiliar remote system.</li>
            <li>An email administrator sees a large number of bounced emails with suspicious content.</li>
            <li>A network administrator notices an unusual deviation from typical network traffic flows.</li>
        </ul>

        <div class="page-number">15 | Page</div>

        <h3>3.2.3 Incident Analysis</h3>
        <p>Incident detection and analysis would be easy if every precursor or indicator were guaranteed to be accurate; unfortunately, this is not the case. For example, user-provided indicators such as a complaint of a server being unavailable are often incorrect. Intrusion detection systems may produce false positives—incorrect indicators. These examples demonstrate what makes incident detection and analysis so difficult: each indicator ideally should be evaluated to determine if it is legitimate. Making matters worse, the total number of indicators may be thousands or millions a day. Finding the real security incidents that occurred out of all the indicators can be a daunting task.</p>
        
        <p>Performing the initial analysis and validation is challenging. The following are recommendations for making incident analysis easier and more effective:</p>
        
        <ul>
            <li><strong>Profile Networks and Systems.</strong> Profiling is measuring the characteristics of expected activity so that changes to it can be more easily identified. Examples of profiling are running file integrity checking software on hosts to derive checksums for critical files and monitoring network bandwidth usage to determine what the average and peak usage levels are on various days and times. In practice, it is difficult to detect incidents accurately using most profiling techniques; organizations should use profiling as one of several detection and analysis techniques.</li>
            <li><strong>Understand Normal Behaviors.</strong> Incident response team members should study networks, systems, and applications to understand what their normal behavior is so that abnormal behavior can be recognized more easily. No incident handler will have a comprehensive knowledge of all behavior throughout the environment, but handlers should know which experts could fill in the gaps. One way to gain this knowledge is through reviewing log entries and security alerts. This may be tedious if filtering is not used to condense the logs to a reasonable size. As handlers become more familiar with the logs and alerts, they should be able to focus on unexplained entries, which are usually more important to investigate. Conducting frequent log reviews should keep the knowledge fresh, and the analyst should be able to notice trends and changes over time. The reviews also give the analyst an indication of the reliability of each source.</li>
            <li><strong>Create a Log Retention Policy.</strong> Information regarding an incident may be recorded in several places, such as firewall, IDPS, and application logs. Creating and implementing a log retention policy that specifies how long log data should be maintained may be extremely helpful in analysis because older log entries may show reconnaissance activity or previous instances of similar attacks. Another reason for retaining logs is that incidents may not be discovered until days, weeks, or even months later. The length of time to maintain log data is dependent on several factors, including the organization's data retention policies and the volume of data. See NIST SP 800-92, Guide to Computer Security Log Management for additional recommendations related to logging.</li>
            <li><strong>Perform Event Correlation.</strong> Evidence of an incident may be captured in several logs that each contain different types of data—a firewall log may have the source IP address that was used, whereas an application log may contain a username. A network IDPS may detect that an attack was launched against a particular host, but it may not know if the attack was successful. The analyst may need to examine the host's logs to determine that information. Correlating events among multiple indicator sources can be invaluable in validating whether a particular incident occurred.</li>
        </ul>

        <div class="page-number">16 | Page</div>
        
        <ul>
            <li><strong>Keep All Host Clocks Synchronized.</strong> Protocols such as the Network Time Protocol (NTP) synchronize clocks among hosts. Event correlation will be more complicated if the devices reporting events have inconsistent clock settings. From an evidentiary standpoint, it is preferable to have consistent timestamps in logs—for example, to have three logs that show an attack occurred at 12:07:01 a.m., rather than logs that list the attack as occurring at 12:07:01, 12:10:35, and 11:07:06.</li>
            <li><strong>Maintain and Use a Knowledge Base of Information.</strong> The knowledge base should include information that handlers need for referencing quickly during incident analysis. Although it is possible to build a knowledge base with a complex structure, a simple approach can be effective. Text documents, spreadsheets, and relatively simple databases provide effective, flexible, and searchable mechanisms for sharing data among team members. The knowledge base should also contain a variety of information, including explanations of the significance and validity of precursors and indicators, such as IDPS alerts, operating system log entries, and application error codes.</li>
            <li><strong>Use Internet Search Engines for Research.</strong> Internet search engines can help analysts find information on unusual activity. For example, an analyst may see some unusual connection attempts targeting TCP port 22912. Performing a search on the terms "TCP," "port," and "22912" may return some hits that contain logs of similar activity or even an explanation of the significance of the port number. Note that separate workstations should be used for research to minimize the risk to the organization from conducting these searches.</li>
            <li><strong>Run Packet Sniffers to Collect Additional Data.</strong> Sometimes the indicators do not record enough detail to permit the handler to understand what is occurring. If an incident is occurring over a network, the fastest way to collect the necessary data may be to have a packet sniffer capture network traffic. Configuring the sniffer to record traffic that matches specified criteria should keep the volume of data manageable and minimize the inadvertent capture of other information. Because of privacy concerns, some organizations may require incident handlers to request and receive permission before using packet sniffers.</li>
            <li><strong>Filter the Data.</strong> There is simply not enough time to review and analyze all the indicators; at minimum the most suspicious activity should be investigated. One effective strategy is to filter out categories of indicators that tend to be insignificant. Another filtering strategy is to show only the categories of indicators that are of the highest significance; however, this approach carries substantial risk because new malicious activity may not fall into one of the chosen indicator categories.</li>
            <li><strong>Seek Assistance from Others.</strong> Occasionally, the team will be unable to determine the full cause and nature of an incident. If the team lacks sufficient information to contain and eradicate the incident, then it should consult with internal resources (e.g., information security staff) and external resources (e.g., US-CERT, other CSIRTs, contractors with incident response expertise). It is important to accurately determine the cause of each incident so that it can be fully contained and the exploited vulnerabilities can be mitigated to prevent similar incidents from occurring.</li>
        </ul>

        <div class="page-number">17 | Page</div>

        <h3>3.2.4 Incident Prioritization</h3>
        <p>Prioritizing the handling of the incident is perhaps the most critical decision point in the incident handling process. Incidents should not be handled on a first-come, first-served basis as a result of resource limitations. Instead, incidents can be prioritized by levels, such as the following:</p>
        
        <table>
            <thead>
                <tr>
                    <th>Priority Level</th>
                    <th>Description</th>
                    <th>Response Time</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr class="priority-critical">
                    <td><strong>Critical (P1)</strong></td>
                    <td>Incidents that cause severe business impact, affect critical systems, or involve sensitive data exposure</td>
                    <td>Immediate (15-30 minutes)</td>
                    <td>
                        <ul>
                            <li>Immediate executive notification</li>
                            <li>24/7 response team activation</li>
                            <li>Potential system isolation</li>
                            <li>Consider external forensic support</li>
                        </ul>
                    </td>
                </tr>
                <tr class="priority-high">
                    <td><strong>High (P2)</strong></td>
                    <td>Incidents with significant business impact, affecting multiple systems or departments</td>
                    <td>Within 1-2 hours</td>
                    <td>
                        <ul>
                            <li>Rapid containment</li>
                            <li>Escalate to security leads</li>
                            <li>Develop incident-specific strategy</li>
                        </ul>
                    </td>
                </tr>
                <tr class="priority-medium">
                    <td><strong>Medium (P3)</strong></td>
                    <td>Incidents with moderate business impact, affecting individual systems or limited scope</td>
                    <td>Within 8 hours</td>
                    <td>
                        <ul>
                            <li>Investigate during business hours</li>
                            <li>Document findings</li>
                            <li>Apply standard remediation</li>
                            <li>Monitor for escalation</li>
                        </ul>
                    </td>
                </tr>
                <tr class="priority-low">
                    <td><strong>Low (P4)</strong></td>
                    <td>Incidents with minimal business impact, routine security events</td>
                    <td>Within 24-48 hours</td>
                    <td>
                        <ul>
                            <li>Standard operating procedures</li>
                            <li>Add to security metrics</li>
                            <li>Schedule remediation</li>
                            <li>Consider for training topics</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="page-number">18 | Page</div>

        <h3>3.2.5 Incident Notification</h3>
        <p>When an incident is analyzed and prioritized, the incident response team needs to notify the appropriate individuals so that all who need to be involved will play their roles. Incident response policies should include provisions concerning incident reporting—at a minimum, what must be reported to whom and at what times (e.g., initial notification, regular status updates). The exact reporting requirements vary among organizations, but parties that are typically notified include:</p>
        
        <ul>
            <li>CIO</li>
            <li>Head of information security</li>
            <li>Local information security officer</li>
            <li>Other incident response teams within the organization</li>
            <li>External incident response teams (if appropriate)</li>
            <li>System owner</li>
            <li>Human resources (for cases involving employees, such as harassment through email)</li>
            <li>Public affairs (for incidents that may generate publicity)</li>
            <li>Legal department (for incidents with potential legal ramifications)</li>
            <li>US-CERT (required for Federal agencies and systems operated on behalf of the Federal government)</li>
            <li>Law enforcement (if appropriate)</li>
        </ul>
        
        <div class="section-highlight">
            <h4>Disclosure Timeline for {{ company_name }}</h4>
            <p><strong>{{ disclosure_time }}</strong></p>
        </div>
        
        <p>During incident handling, the team may need to provide status updates to certain parties, even in some cases the entire organization. The team should plan and prepare several communication methods, including out-of-band methods (e.g., in person, paper), and select the methods that are appropriate for a particular incident. Possible communication methods include:</p>
        
        <ul>
            <li>Email</li>
            <li>Website (internal, external, or portal)</li>
            <li>Telephone calls</li>
            <li>In person (e.g., daily briefings)</li>
            <li>Voice mailbox greeting (e.g., set up a separate voice mailbox for incident updates, and update the greeting message to reflect the current incident status; use the help desk's voice mail greeting)</li>
            <li>Paper (e.g., post notices on bulletin boards and doors, hand out notices at all entrance points).</li>
        </ul>

        <div class="page-number">19 | Page</div>

        <h2 id="containment-eradication-recovery">3.3 Containment, Eradication, and Recovery</h2>

        <h3>3.3.1 Choosing a Containment Strategy</h3>
        <p>Containment is important before an incident overwhelms resources or increases damage. Most incidents require containment, so that is an important consideration early in the course of handling each incident. Containment provides time for developing a tailored remediation strategy. An essential part of containment is decision-making (e.g., shut down a system, disconnect it from a network, disable certain functions). Such decisions are much easier to make if there are predetermined strategies and procedures for containing the incident. Organizations should define acceptable risks in dealing with incidents and develop strategies accordingly.</p>
        
        <p>Criteria for determining the appropriate strategy include:</p>
        <ul>
            <li>Potential damage to and theft of resources</li>
            <li>Need for evidence preservation</li>
            <li>Service availability (e.g., network connectivity, services provided to external parties)</li>
            <li>Time and resources needed to implement the strategy</li>
            <li>Effectiveness of the strategy (e.g., partial containment, full containment)</li>
            <li>Duration of the solution (e.g., emergency workaround to be removed in four hours, temporary workaround to be removed in two weeks, permanent solution).</li>
        </ul>

        <div class="dynamic-section">
            {{ containment_section }}
        </div>

        <h3>3.3.2 Evidence Gathering and Handling</h3>
        <p>Although the primary reason for gathering evidence during an incident is to resolve the incident, it may also be needed for legal proceedings. In such cases, it is important to clearly document how all evidence, including compromised systems, has been preserved. Evidence should be collected according to procedures that meet all applicable laws and regulations that have been developed from previous discussions with legal staff and appropriate law enforcement agencies so that any evidence can be admissible in court. In addition, evidence should be accounted for at all times; whenever evidence is transferred from person to person, chain of custody forms should detail the transfer and include each party's signature. A detailed log should be kept for all evidence, including the following:</p>
        
        <ul>
            <li>Identifying information (e.g., the location, serial number, model number, hostname, media access control (MAC) addresses, and IP addresses of a computer)</li>
            <li>Name, title, and phone number of each individual who collected or handled the evidence during the investigation</li>
            <li>Time and date (including time zone) of each occurrence of evidence handling</li>
            <li>Locations where the evidence was stored.</li>
        </ul>

        <div class="page-number">20 | Page</div>

        <h3>3.3.3 Identifying the Attacking Hosts</h3>
        <p>During incident handling, system owners and others sometimes want to or need to identify the attacking host or hosts. Although this information can be important, incident handlers should generally stay focused on containment, eradication, and recovery. Identifying an attacking host can be a time-consuming and futile process that can prevent a team from achieving its primary goal—minimizing the business impact. The following items describe the most commonly performed activities for attacking host identification:</p>
        
        <ul>
            <li><strong>Validating the Attacking Host's IP Address.</strong> New incident handlers often focus on the attacking host's IP address. The handler may attempt to validate that the address was not spoofed by verifying connectivity to it; however, this simply indicates that a host at that address does or does not respond to the requests. A failure to respond does not mean the address is not real—for example, a host may be configured to ignore pings and traceroutes. Also, the attacker may have received a dynamic address that has already been reassigned to someone else.</li>
            <li><strong>Researching the Attacking Host through Search Engines.</strong> Performing an Internet search using the apparent source IP address of an attack may lead to more information on the attack—for example, a mailing list message regarding a similar attack.</li>
            <li><strong>Using Incident Databases.</strong> Several groups collect and consolidate incident data from various organizations into incident databases. This information sharing may take place in many forms, such as trackers and real-time blacklists. The organization can also check its own knowledge base or issue tracking system for related activity.</li>
            <li><strong>Monitoring Possible Attacker Communication Channels.</strong> Incident handlers can monitor communication channels that may be used by an attacking host. For example, many bots use IRC as their primary means of communication. Also, attackers may congregate on certain IRC channels to brag about their compromises and share information. However, incident handlers should treat any such information that they acquire only as a potential lead, not as fact.</li>
        </ul>

        <h3>3.3.4 Eradication and Recovery</h3>
        <p>After an incident has been contained, eradication may be necessary to eliminate components of the incident, such as deleting malware and disabling breached user accounts, as well as identifying and mitigating all vulnerabilities that were exploited. During eradication, it is important to identify all affected hosts within the organization so that they can be remediated. For some incidents, eradication is either not necessary or is performed during recovery.</p>
        
        <p>In recovery, administrators restore systems to normal operation, confirm that the systems are functioning normally, and (if applicable) remediate vulnerabilities to prevent similar incidents. Recovery may involve such actions as restoring systems from clean backups, rebuilding systems from scratch, replacing compromised files with clean versions, installing patches, changing passwords, and tightening network perimeter security (e.g., firewall rulesets, boundary router access control lists). Higher levels of system logging or network monitoring are often part of the recovery process. Once a resource is successfully attacked, it is often attacked again, or other resources within the organization are attacked in a similar manner.</p>

        <div class="section-highlight">
            <h4>Backup and Recovery Systems for {{ company_name }}</h4>
            <p><strong>Backup System:</strong> {{ backup_system }}</p>
        </div>

        <div class="dynamic-section">
            {{ recovery_section }}
        </div>

        <div class="page-number">21 | Page</div>

        <h2 id="post-incident">3.4 Post-Incident Activity</h2>

        <h3>3.4.1 Lessons Learned</h3>
        <p>One of the most important parts of incident response is also the most often omitted: learning and improving. Each incident response team should evolve to reflect new threats, improved technology, and lessons learned. Holding a "lessons learned" meeting with all involved parties after a major incident, and optionally periodically after lesser incidents as resources permit, can be extremely helpful in improving security measures and the incident handling process itself. Multiple incidents can be covered in a single lessons learned meeting. This meeting provides a chance to achieve closure with respect to an incident by reviewing what occurred, what was done to intervene, and how well intervention worked. The meeting should be held within several days of the end of the incident. Questions to be answered in the meeting include:</p>

        <div class="dynamic-section">
            {{ threat_response_section }}
        </div>

        <h3>3.4.2 Using Collected Incident Data</h3>
        <p>Lessons learned activities should produce a set of objective and subjective data regarding each incident. Over time, the collected incident data should be useful in several capacities. The data, particularly the total hours of involvement and the cost, may be used to justify additional funding of the incident response team. A study of incident characteristics may indicate systemic security weaknesses and threats, as well as changes in incident trends. This data can be put back into the risk assessment process, ultimately leading to the selection and implementation of additional controls.</p>
        
        <p>Possible metrics for incident-related data include:</p>
        <ul>
            <li>Number of Incidents Handled.</li>
            <li>Time Per Incident.</li>
            <li>Objective analysis.</li>
            <li>Subjective Assessment of Each Incident</li>
        </ul>

        <div class="page-number">22 | Page</div>

        <h3>3.4.3 Evidence Retention</h3>
        <p>Organizations should establish policy for how long evidence from an incident should be retained. Most organizations choose to retain all evidence for months or years after the incident ends. The following factors should be considered during the policy creation:</p>
        
        <ul>
            <li><strong>Prosecution.</strong> If it is possible that the attacker will be prosecuted, evidence may need to be retained until all legal actions have been completed. In some cases, this may take several years. Furthermore, evidence that seems insignificant now may become more important in the future. For example, if an attacker is able to use knowledge gathered in one attack to perform a more severe attack later, evidence from the first attack may be key to explaining how the second attack was accomplished.</li>
            <li><strong>Data Retention.</strong> Most organizations have data retention policies that state how long certain types of data may be kept. For example, an organization may state that email messages should be retained for only 180 days. If a disk image contains thousands of emails, the organization may not want the image to be kept for more than 180 days unless it is absolutely necessary.</li>
            <li><strong>Cost.</strong> Original hardware (e.g., hard drives, compromised systems) that is stored as evidence, as well as hard drives and removable media that are used to hold disk images, are generally individually inexpensive. However, if an organization stores many such components for years, the cost can be substantial. The organization also must retain functional computers that can use the stored hardware and media.</li>
        </ul>

        <div class="dynamic-section">
            {{ response_playbooks }}
        </div>

        <div class="page-number">23 | Page</div>

        <div class="checklist">
            <h3>3.4.4 Incident Handling Checklist</h3>
            <p>The checklist in Table 3-5 provides the major steps to be performed in the handling of an incident. Note that the actual steps performed may vary based on the type of incident and the nature of individual incidents. For example, if the handler knows exactly what has happened based on analysis of indicators (Step 1.1), there may be no need to perform Steps 1.2 or 1.3 to further research the activity. The checklist provides guidelines to handlers on the major steps that should be performed; it does not dictate the exact sequence of steps that should always be followed.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>Completed</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2"><strong>Detection and Analysis</strong></td>
                    </tr>
                    <tr>
                        <td>1. Determine whether an incident has occurred</td>
                        <td style="width: 100px;">☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;1.1 Analyze the precursors and indicators</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;1.2 Look for correlating information</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;1.3 Perform research (e.g., search engines, knowledge base)</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;1.4 As soon as the handler believes an incident has occurred, begin documenting the investigation and gathering evidence</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>2. Prioritize handling the incident based on the relevant factors (functional impact, information impact, recoverability effort, etc.)</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>3. Report the incident to the appropriate internal personnel and external organizations</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td colspan="2"><strong>Containment, Eradication, and Recovery</strong></td>
                    </tr>
                    <tr>
                        <td>4. Acquire, preserve, secure, and document evidence</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>5. Contain the incident</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>6. Eradicate the incident</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;6.1 Identify and mitigate all vulnerabilities that were exploited</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;6.2 Remove malware, inappropriate materials, and other components</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;6.3 If more affected hosts are discovered (e.g., new malware infections), repeat the Detection and Analysis steps (1.1, 1.2) to identify all other affected hosts, then contain (5) and eradicate (6) the incident for them</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>7. Recover from the incident</td>
                        <td>☐</td>
                    </tr>
                    <tr>
                        <td>&nbsp;&nbsp;7.1 Return affected systems to an operationally ready state</td>
                        <td>☐</td>
                        </div>

        <!-- Section 3.4.4: Incident Handling Checklist -->
        <div class="section">
            <h2>3.4.4 Incident Handling Checklist</h2>
            <p>The following checklist provides the major steps to be performed in the handling of an incident. Note that the actual steps performed may vary based on the type of incident and the nature of individual incidents.</p>
            
            <table class="checklist-table">
                <thead>
                    <tr>
                        <th style="width: 60px;">Status</th>
                        <th>Action</th>
                        <th style="width: 150px;">Assigned To</th>
                        <th style="width: 120px;">Date/Time</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="section-header">
                        <td colspan="4"><strong>Detection and Analysis</strong></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>1. Determine whether an incident has occurred</strong></td>
                        <td>{{ incident_commander }}</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;1.1 Analyze the precursors and indicators</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;1.2 Look for correlating information</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;1.3 Perform research (search engines, knowledge base)</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;1.4 Begin documenting investigation and gathering evidence</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>2. Prioritize handling based on relevant factors</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>3. Report incident to appropriate personnel and organizations</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr class="section-header">
                        <td colspan="4"><strong>Containment, Eradication, and Recovery</strong></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>4. Acquire, preserve, secure, and document evidence</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>5. Contain the incident</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="4">{{ containment_section }}</td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>6. Eradicate the incident</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;6.1 Identify and mitigate all exploited vulnerabilities</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;6.2 Remove malware, inappropriate materials, and other components</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;6.3 If more affected hosts discovered, repeat Detection and Analysis steps</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>7. Recover from the incident</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;7.1 Return affected systems to operationally ready state</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;7.2 Confirm affected systems are functioning normally</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td>&nbsp;&nbsp;7.3 Implement additional monitoring for future related activity</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="4">{{ recovery_section }}</td>
                    </tr>
                    <tr class="section-header">
                        <td colspan="4"><strong>Post-Incident Activity</strong></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>8. Create a follow-up report</strong></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>☐</td>
                        <td><strong>9. Hold lessons learned meeting</strong> (mandatory for major incidents)</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="4">{{ prior_breach_section }}</td>
                    </tr>
                    <tr>
                        <td colspan="4">{{ response_playbooks }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section 4: Coordination and Information Sharing -->
        <div class="section">
            <h1>4. Coordination and Information Sharing</h1>
            
            <h2>4.1 Coordination</h2>
            <p>{{ company_name }} may need to interact with several types of external organizations during incident response activities. Examples include other incident response teams, law enforcement agencies, Internet service providers, and constituents and customers.</p>
            
            <p>The incident response team should plan coordination with external parties before incidents occur to ensure all parties understand their roles and establish effective communication lines. Organizations should consider building relationships within their industry sector and geographic region.</p>

            <div class="info-box">
                <h3>Key Coordination Partners</h3>
                <ul>
                    <li><strong>Internal Teams:</strong> {{ audience_roles }}</li>
                    <li><strong>External Partners:</strong> Law enforcement, ISPs, cloud providers</li>
                    <li><strong>Cloud Services:</strong> {{ cloud_services | join(', ') }}</li>
                    <li><strong>Regulatory Bodies:</strong> Industry-specific compliance organizations</li>
                </ul>
            </div>

            <h2>4.2 Information Sharing Techniques</h2>
            <p>Information sharing is a key element of enabling coordination across organizations. {{ company_name }} should perform information sharing throughout the incident response lifecycle, not waiting until an incident is fully resolved.</p>

            <h3>4.2.1 Ad Hoc Methods</h3>
            <p>Most incident information sharing occurs through ad hoc methods such as:</p>
            <ul>
                <li>Email communications</li>
                <li>Instant messaging clients</li>
                <li>Phone calls and conference bridges</li>
                <li>Secure communication platforms</li>
            </ul>

            <h3>4.2.2 Partially Automated Methods</h3>
            <p>{{ company_name }} should attempt to automate information sharing processes where possible to make cross-organizational coordination efficient and cost-effective. This includes:</p>
            <ul>
                <li>Automated threat intelligence feeds</li>
                <li>Security information sharing platforms</li>
                <li>Incident tracking system integrations</li>
                <li>API-based data exchanges</li>
            </ul>

            <h3>4.2.3 Security Considerations</h3>
            <p>Several security considerations must be addressed when planning information sharing:</p>
            <ul>
                <li>Designating who can access different pieces of incident information</li>
                <li>Data sanitization to remove sensitive information</li>
                <li>Protection of information shared by other organizations</li>
                <li>Compliance with data protection regulations</li>
            </ul>

            <h2>4.3 Granular Information Sharing</h2>
            <p>{{ company_name }} must balance the benefits of information sharing with the drawbacks of sharing sensitive information. Organizations should share necessary information only with appropriate parties.</p>

            <h3>4.3.1 Business Impact Information</h3>
            <p>Business impact information includes how the incident affects {{ company_name }} in terms of:</p>
            <ul>
                <li>Mission impact</li>
                <li>Financial impact</li>
                <li>Operational disruption</li>
                <li>Reputation damage</li>
            </ul>

            <h3>4.3.2 Technical Information</h3>
            <p>Technical indicators that may be shared include:</p>
            <ul>
                <li>Hostnames and IP addresses of attacking hosts</li>
                <li>Malware samples and signatures</li>
                <li>Precursors and indicators of similar incidents</li>
                <li>Types of vulnerabilities exploited</li>
                <li>Attack methodologies and techniques</li>
            </ul>
        </div>

        <!-- Appendices -->
        <div class="section">
            <h1>Appendices</h1>

            <h2>Appendix A: Situation Update Template</h2>
            <table class="template-table">
                <tr><td><strong>Date of Entry:</strong></td><td>{{ current_date }}</td><td><strong>Time of Entry:</strong></td><td>{{ current_time }}</td></tr>
                <tr><td><strong>Author:</strong></td><td>{{ incident_commander }}</td><td><strong>Date and Time Incident Detected:</strong></td><td></td></tr>
                <tr><td><strong>Current Status:</strong></td><td colspan="3">☐ New &nbsp;&nbsp; ☐ In Progress &nbsp;&nbsp; ☐ Resolved</td></tr>
                <tr><td><strong>Incident Type:</strong></td><td colspan="3"></td></tr>
                <tr><td><strong>Incident Classification:</strong></td><td colspan="3">☐ Incident &nbsp;&nbsp; ☐ Significant Incident &nbsp;&nbsp; ☐ Emergency</td></tr>
                <tr><td><strong>Scope:</strong></td><td colspan="3">List affected networks, systems, and applications</td></tr>
                <tr><td><strong>Impact:</strong></td><td colspan="3">List affected stakeholders</td></tr>
                <tr><td><strong>Severity:</strong></td><td colspan="3">Outline impact on stakeholders</td></tr>
                <tr><td><strong>Notifications Actioned/Pending:</strong></td><td colspan="3"></td></tr>
                <tr><td><strong>Additional Notes:</strong></td><td colspan="3"></td></tr>
                <tr><td><strong>Contact Details for Incident Manager:</strong></td><td colspan="3">{{ incident_commander }}</td></tr>
                <tr><td><strong>Date and Time of Next Update:</strong></td><td colspan="3"></td></tr>
            </table>

            <h2>Appendix B: Resolution Action Plan Template</h2>
            <table class="template-table">
                <thead>
                    <tr>
                        <th>Date and Time</th>
                        <th>Category</th>
                        <th>Action</th>
                        <th>Action Owner</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td>Contain</td>
                        <td></td>
                        <td></td>
                        <td>☐ Unallocated ☐ In Progress ☐ Closed</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Eradicate</td>
                        <td></td>
                        <td></td>
                        <td>☐ Unallocated ☐ In Progress ☐ Closed</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Recover</td>
                        <td></td>
                        <td></td>
                        <td>☐ Unallocated ☐ In Progress ☐ Closed</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Communications</td>
                        <td></td>
                        <td></td>
                        <td>☐ Unallocated ☐ In Progress ☐ Closed</td>
                    </tr>
                </tbody>
            </table>

            <h2>Appendix C: Evidence Register Template</h2>
            <table class="template-table">
                <thead>
                    <tr>
                        <th>Date, Time, and Location of Collection</th>
                        <th>Collected By</th>
                        <th>Item Details</th>
                        <th>Storage Location</th>
                        <th>Access Log</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td>Name, title, contact, phone</td>
                        <td>Quantity, serial number, model, hostname, MAC address, IP addresses</td>
                        <td>Location and label number</td>
                        <td>Date, time, person, rationale for access</td>
                    </tr>
                </tbody>
            </table>

            <h2>Appendix D: Assets and Key Contacts Template</h2>
            <div class="info-box">
                <h3>Site Information</h3>
                <table class="template-table">
                    <tr><td><strong>IP Subnet:</strong></td><td>{{ network_subnet }}</td></tr>
                    <tr><td><strong>DHCP Scope:</strong></td><td></td></tr>
                    <tr><td><strong>Core Router IP:</strong></td><td></td></tr>
                    <tr><td><strong>DNS Servers (Internal):</strong></td><td></td></tr>
                    <tr><td><strong>Cloud Services:</strong></td><td>{{ cloud_services | join(', ') }}</td></tr>
                    <tr><td><strong>Backup System:</strong></td><td>{{ backup_system }}</td></tr>
                </table>
            </div>

            <div class="info-box">
                <h3>Key Contacts</h3>
                <table class="template-table">
                    <tr><td><strong>Incident Commander:</strong></td><td>{{ incident_commander }}</td></tr>
                    <tr><td><strong>IT Security Team:</strong></td><td>{{ security_team_contact }}</td></tr>
                    <tr><td><strong>Legal Department:</strong></td><td>{{ legal_contact }}</td></tr>
                    <tr><td><strong>Public Relations:</strong></td><td>{{ pr_contact }}</td></tr>
                    <tr><td><strong>Executive Team:</strong></td><td>{{ executive_contact }}</td></tr>
                    <tr><td><strong>External Partners:</strong></td><td>{{ external_partners }}</td></tr>
                </table>
            </div>
        </div>

        <!-- Glossary -->
        <div class="section">
            <h1>Appendix E: Glossary</h1>
            <dl class="glossary">
                <dt>Baselining</dt>
                <dd>Monitoring resources to determine typical utilization patterns so that significant deviations can be detected.</dd>
                
                <dt>Computer Security Incident</dt>
                <dd>A violation or imminent threat of violation of computer security policies, acceptable use policies, or standard security practices.</dd>
                
                <dt>Computer Security Incident Response Team (CSIRT)</dt>
                <dd>A capability set up for the purpose of assisting in responding to computer security-related incidents; also called a Computer Incident Response Team (CIRT) or a CIRC.</dd>
                
                <dt>Event</dt>
                <dd>Any observable occurrence in a network or system.</dd>
                
                <dt>False Positive</dt>
                <dd>An alert that incorrectly indicates that malicious activity is occurring.</dd>
                
                <dt>Incident</dt>
                <dd>A violation or imminent threat of violation of computer security policies, acceptable use policies, or standard security practices.</dd>
                
                <dt>Incident Handling</dt>
                <dd>The mitigation of violations of security policies and recommended practices.</dd>
                
                <dt>Incident Response</dt>
                <dd>See "incident handling."</dd>
                
                <dt>Indicator</dt>
                <dd>A sign that an incident may have occurred or may be currently occurring.</dd>
                
                <dt>Intrusion Detection and Prevention System (IDPS)</dt>
                <dd>Software that automates the process of monitoring events in a computer system or network and analyzing them for signs of possible incidents.</dd>
                
                <dt>Malware</dt>
                <dd>A virus, worm, Trojan horse, or other code-based malicious entity that successfully infects a host.</dd>
                
                <dt>Precursor</dt>
                <dd>A sign that an attacker may be preparing to cause an incident.</dd>
                
                <dt>Profiling</dt>
                <dd>Measuring the characteristics of expected activity so that changes to it can be more easily identified.</dd>
                
                <dt>Signature</dt>
                <dd>A recognizable, distinguishing pattern associated with an attack.</dd>
                
                <dt>Social Engineering</dt>
                <dd>An attempt to trick someone into revealing information that can be used to attack systems or networks.</dd>
                
                <dt>Threat</dt>
                <dd>The potential source of an adverse event.</dd>
                
                <dt>Vulnerability</dt>
                <dd>A weakness in a system, application, or network that is subject to exploitation or misuse.</dd>
            </dl>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>Document Information:</strong></p>
            <p>Organization: {{ company_name }}</p>
            <p>Prepared by: {{ document_authors }}</p>
            <p>Version: {{ document_version }}</p>
            <p>Last Updated: {{ last_updated }}</p>
            <p><strong>Confidentiality Notice:</strong> This document contains sensitive security information and should be handled according to {{ company_name }}'s information classification policy.</p>
            <p><strong>Disclaimer:</strong> This document is based on guidelines from the National Institute of Standards and Technology (NIST). The authors cannot access any confidential information filled in the appendices.</p>
        </div>
    </div>
</body>
</html>